<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
<link rel="stylesheet" href="{{ get_static_url('/static/css/style.css') }}">
<nav class="navbar navbar-expand-lg">
  <div class="container-fluid">
    <!-- Brand + Nav links -->
    <div class="d-flex align-items-center">
      {% if branding is defined and branding.hide_spark_branding and branding.is_custom_domain %}
      <a class="navbar-brand fw-bold d-flex align-items-center gap-2" href="/">
        {% if branding.logo_url %}<img src="{{ branding.logo_url }}" alt="{{ branding.company_name }}" height="28">{% endif %}
        {{ branding.company_name }}
      </a>
      {% elif branding is defined and branding.context_type == 'storefront' %}
      <a class="navbar-brand fw-bold" href="/home">
        {{ branding.company_name or 'Spark' }}
        <small class="text-muted" style="font-size: 0.6em; vertical-align: middle;">on Spark</small>
      </a>
      {% else %}
      <a class="navbar-brand fw-bold" href="/home">Spark</a>
      {% endif %}
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
    </div>
    <div class="collapse navbar-collapse" id="navbarNavDropdown">
      <ul class="navbar-nav mx-auto">
        <li class="nav-item">
          <a class="nav-link" href="/home">
            <i class="fas fa-home me-1"></i>Home
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/chat">
            <i class="fas fa-comments me-1"></i>Chat
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/explore">
            <i class="fas fa-compass me-1"></i>Explore
          </a>
        </li>
        {% if is_admin|default(false) or is_manager|default(false) %}
        <li class="nav-item">
          <a class="nav-link" href="/dashboard">
            <i class="fas fa-tachometer-alt me-1"></i>Dashboard
          </a>
        </li>
        {% endif %}
      </ul>
      <!-- User dropdown (right side) -->
      <ul class="navbar-nav">
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle d-flex align-items-center gap-2" href="#" id="userDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            {% if navbar_avatar_url %}
            <img src="{{ navbar_avatar_url }}" alt="" class="navbar-user-avatar">
            {% else %}
            <span class="navbar-user-avatar navbar-user-initials">{{ navbar_initials }}</span>
            {% endif %}
            <span class="navbar-user-name d-none d-sm-inline">{{ username }}</span>
          </a>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
          <li><a class="dropdown-item" href="/settings"><i class="fas fa-cog"></i> Settings</a></li>
          <li><a class="dropdown-item" href="/media-gallery"><i class="fas fa-images"></i> Media Gallery</a></li>
          <li><hr class="dropdown-divider"></li>
          <!-- Theme submenu -->
          <li class="dropstart">
            <a class="dropdown-item dropdown-toggle" href="#" data-bs-toggle="dropdown" aria-expanded="false">
              <i class="fas fa-palette"></i> Theme
            </a>
            <ul class="dropdown-menu theme-submenu">
              <li><a class="dropdown-item theme-option" href="#" data-theme="default">Default</a></li>
              <li><a class="dropdown-item theme-option" href="#" data-theme="light">Light</a></li>
              <li><a class="dropdown-item theme-option" href="#" data-theme="writer">Writer</a></li>
              <li><a class="dropdown-item theme-option" href="#" data-theme="coder">Coder</a></li>
              <li><a class="dropdown-item theme-option" href="#" data-theme="terminal">Terminal</a></li>
              <li><a class="dropdown-item theme-option" href="#" data-theme="eink">E-Ink</a></li>
              <li><a class="dropdown-item theme-option" href="#" data-theme="nekoglass">Neko Glass</a></li>
              <li><a class="dropdown-item theme-option" href="#" data-theme="frutigeraero">Frutiger Aero</a></li>
              <li><a class="dropdown-item theme-option" href="#" data-theme="memphis">Memphis</a></li>
              <li><a class="dropdown-item theme-option" href="#" data-theme="katarishoji">Katari Shoji</a></li>
              <li><a class="dropdown-item theme-option" href="#" data-theme="xmas">Christmas</a></li>
              <li><a class="dropdown-item theme-option" href="#" data-theme="halloween">Halloween</a></li>
              <li><a class="dropdown-item theme-option" href="#" data-theme="valentinesday">Valentine's Day</a></li>
            </ul>
          </li>
          <li><hr class="dropdown-divider"></li>
          <li><a class="dropdown-item text-danger" href="/logout" onclick="handleLogout(event)"><i class="fas fa-sign-out-alt"></i> Log out</a></li>
        </ul>
        </li>
      </ul>
    </div>
  </div>
</nav>

<script>
  function handleLogout(event) {
    event.preventDefault();
    window.location.href = '/logout';
  }
</script>
<script src="{{ get_static_url('/static/js/themeManager.js') }}"></script>
<script src="{{ get_static_url('/static/js/nekoglass-controls.js') }}"></script>
